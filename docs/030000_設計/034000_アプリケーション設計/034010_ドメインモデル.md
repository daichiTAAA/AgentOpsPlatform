---
title: ドメインモデル
version: "1.0"
status: draft
owner: システム開発チーム
updated: 2025-09-07
related_requirements: ["FR-001", "FR-002", "FR-003", "FR-007", "FR-008", "FR-010"]
---

# ドメインモデル

## 📋 文書情報

| 項目       | 内容                                                         |
| ---------- | ------------------------------------------------------------ |
| **文書名** | ソロプレナー／AIネイティブ企業基盤システム（ドメインモデル） |
| **版数**   | 1.0                                                          |
| **作成日** | 2025-09-07                                                   |
| **更新日** | 2025-09-07                                                   |
| **作成者** | システム開発チーム                                           |

---

## 🎯 1. ドメインモデル概要

本システムは、人間とAIエージェントが協調して業務を遂行する統合基盤であり、以下の主要ドメインから構成されます：

```mermaid
graph TD
    subgraph "🏢 Organization Domain"
        direction TB
        ORG[Organization]
        USER[User]
        ROLE[Role]
    end

    subgraph "📋 Project Management Domain"
        direction TB
        PROJ[Project]
        TASK[Task]
        MILESTONE[Milestone]
    end

    subgraph "🤖 AI Agent Domain"
        direction TB
        AGENT[AI Agent]
        EXEC[Execution]
        RESULT[Result]
    end
    
    subgraph "🤝 Collaboration Domain"
        direction TB
        WORKFLOW[Workflow]
        APPROVAL[Approval]
        REVIEW[Review]
    end

    subgraph "📚 Knowledge Domain"
        direction TB
        KNOWLEDGE[Knowledge Base]
        DOCUMENT[Document]
        REFERENCE[Reference]
    end
    
    subgraph "🔍 Audit Domain"
        direction TB
        AUDIT[Audit Log]
        EVENT[Event]
        TRACE[Trace]
    end

    %% Organization Domain 内の関係
    ORG --> USER
    USER --> ROLE

    %% ドメイン間の基本関係
    ORG --> PROJ
    USER --> PROJ
    USER --> TASK

    %% Project Management Domain 内の関係
    PROJ --> TASK
    PROJ --> MILESTONE
    TASK --> MILESTONE

    %% AI Agent Domain 内の関係
    AGENT --> EXEC
    EXEC --> RESULT

    %% Collaboration Domain 内の関係
    WORKFLOW --> APPROVAL
    WORKFLOW --> REVIEW
    APPROVAL --> REVIEW

    %% Knowledge Domain 内の関係
    KNOWLEDGE --> DOCUMENT
    DOCUMENT --> REFERENCE

    %% Audit Domain 内の関係
    AUDIT --> EVENT
    EVENT --> TRACE

    %% 人機協調のための重要な関係
    TASK --> AGENT
    TASK --> WORKFLOW
    USER --> WORKFLOW
    AGENT --> KNOWLEDGE
    EXEC --> AUDIT
```

---

## 🏗️ 2. 境界づけられたコンテキスト

### 2.1 コンテキストマップ

```mermaid
graph LR
    subgraph "🔐 Identity & Access Context"
        IAM[Identity & Access Management]
    end
    
    subgraph "📋 Project Management Context"
        PM[Project Management]
    end
    
    subgraph "🤖 AI Agent Context"
        AI[AI Agent Management]
    end
    
    subgraph "🤝 Human-AI Collaboration Context"
        COLLAB[Collaboration Management]
    end
    
    subgraph "📚 Knowledge Management Context"
        KM[Knowledge Management]
    end
    
    subgraph "🔍 Audit & Compliance Context"
        AUDIT[Audit & Compliance]
    end
    
    subgraph "🔗 External Integration Context"
        EXT[External Integration]
    end
    
    IAM -.->|Conformist| PM
    IAM -.->|Conformist| AI
    PM <-->|Partnership| COLLAB
    AI <-->|Partnership| COLLAB
    KM -->|Upstream| AI
    AUDIT <-.->|Anti-corruption| PM
    AUDIT <-.->|Anti-corruption| AI
    EXT -.->|Open Host Service| PM
    EXT -.->|Open Host Service| AI
```

| コンテキスト             | 責務                     | 主要エンティティ              | 統合パターン      |
| ------------------------ | ------------------------ | ----------------------------- | ----------------- |
| **🔐 Identity & Access**  | 認証・認可・ユーザー管理 | User, Role, Permission        | Shared Kernel     |
| **📋 Project Management** | プロジェクト・タスク管理 | Project, Task, Milestone      | Customer-Supplier |
| **🤖 AI Agent**           | AIエージェント実行・管理 | Agent, Execution, Model       | Partnership       |
| **🤝 Collaboration**      | 人機協調・承認フロー     | Workflow, Approval, Review    | Partnership       |
| **📚 Knowledge**          | ナレッジ管理・検索       | Knowledge, Document, Citation | Upstream          |
| **🔍 Audit**              | 監査・コンプライアンス   | AuditLog, Event, Trace        | Anti-corruption   |
| **🔗 Integration**        | 外部システム連携         | Integration, Endpoint, Sync   | Open Host Service |

---

## 3. Identity & Access Management Context

### 3.1 概念モデル

```mermaid
classDiagram
    class Organization {
        +UUID id
        +String name
        +String domain
        +OrganizationType type
        +DateTime createdAt
        +DateTime updatedAt
        +activate()
        +deactivate()
    }
    
    class User {
        +UUID id
        +String email
        +String name
        +UserType type
        +UserStatus status
        +DateTime lastLoginAt
        +authenticate()
        +assignRole()
        +revokeRole()
    }
    
    class Role {
        +UUID id
        +String name
        +String description
        +Set~Permission~ permissions
        +addPermission()
        +removePermission()
    }
    
    class Permission {
        +UUID id
        +String resource
        +String action
        +String condition
        +validate()
    }
    
    class UserRole {
        +UUID userId
        +UUID roleId
        +DateTime assignedAt
        +DateTime expiresAt
        +User assignedBy
    }
    
    Organization "1" --> "*" User : "employs"
    User "1" --> "*" UserRole : "has"
    Role "1" --> "*" UserRole : "assigned to"
    Role "1" --> "*" Permission : "grants"
    
    class UserType {
        <<enumeration>>
        HUMAN
        AI_AGENT
        SYSTEM
    }
    
    class UserStatus {
        <<enumeration>>
        ACTIVE
        INACTIVE
        SUSPENDED
    }
    
    class OrganizationType {
        <<enumeration>>
        SOLOPRENEUR
        AI_NATIVE_COMPANY
        TRADITIONAL_COMPANY
    }
```

### 3.2 重要な不変条件

| エンティティ   | 不変条件                                                  | ビジネスルール                                             |
| -------------- | --------------------------------------------------------- | ---------------------------------------------------------- |
| **User**       | • 同一組織内でemail一意<br>• AI_AGENTは人間による作成必須 | • 管理者権限は人間のみ<br>• AIエージェントは特定権限のみ   |
| **Role**       | • 組織内でname一意<br>• 最小権限原則                      | • 管理者ロールは削除不可<br>• AIエージェント専用ロール存在 |
| **Permission** | • resource+action+conditionで一意                         | • 重要操作は承認必須<br>• 監査ログアクセスは制限           |

---

## 📋 4. Project Management Context

### 4.1 概念モデル

```mermaid
classDiagram
    class Project {
        +UUID id
        +String name
        +String description
        +ProjectStatus status
        +Priority priority
        +DateTime startDate
        +DateTime endDate
        +User owner
        +List~Task~ tasks
        +addTask()
        +updateStatus()
        +calculateProgress()
    }
    
    class Task {
        +UUID id
        +String title
        +String description
        +TaskStatus status
        +Priority priority
        +TaskType type
        +User assignee
        +DateTime dueDate
        +Duration estimatedEffort
        +Duration actualEffort
        +assign()
        +complete()
        +updateProgress()
    }
    
    class Milestone {
        +UUID id
        +String name
        +String description
        +DateTime targetDate
        +DateTime actualDate
        +MilestoneStatus status
        +Set~Task~ dependencies
        +achieve()
        +postpone()
    }
    
    class WorkBreakdownStructure {
        +UUID id
        +Project project
        +Task parentTask
        +List~Task~ childTasks
        +Integer level
        +decompose()
        +optimize()
    }
    
    class Dependency {
        +UUID id
        +Task predecessor
        +Task successor
        +DependencyType type
        +Duration lag
        +validate()
    }
    
    Project "1" --> "*" Task : "contains"
    Project "1" --> "*" Milestone : "has"
    Task "1" --> "*" WorkBreakdownStructure : "structured by"
    Task "1" --> "*" Dependency : "depends on"
    Milestone "1" --> "*" Task : "includes"
    
    class ProjectStatus {
        <<enumeration>>
        PLANNING
        ACTIVE
        ON_HOLD
        COMPLETED
        CANCELLED
    }
    
    class TaskStatus {
        <<enumeration>>
        TODO
        IN_PROGRESS
        REVIEW
        DONE
        BLOCKED
    }
    
    class TaskType {
        <<enumeration>>
        HUMAN_TASK
        AI_TASK
        COLLABORATIVE_TASK
        APPROVAL_TASK
    }
```

### 4.2 ドメインサービス

```mermaid
classDiagram
    class ProjectPlanningService {
        +generateWBS(Project project)
        +optimizeSchedule(Project project)
        +identifyRisks(Project project)
        +estimateEffort(Task task)
    }
    
    class TaskAssignmentService {
        +assignOptimalResource(Task task)
        +balanceWorkload(List~User~ users)
        +suggestAIAssignment(Task task)
    }
    
    class ProgressTrackingService {
        +calculateProjectProgress(Project project)
        +detectDelays(Project project)
        +predictCompletion(Project project)
        +generateStatusReport(Project project)
    }
    
    ProjectPlanningService ..> Project
    TaskAssignmentService ..> Task
    ProgressTrackingService ..> Project
```

---

## 🤖 5. AI Agent Management Context

### 5.1 概念モデル

```mermaid
classDiagram
    class AIAgent {
        +UUID id
        +String name
        +AgentType type
        +AgentCapability capabilities
        +AgentStatus status
        +String modelVersion
        +Configuration config
        +DateTime lastActiveAt
        +execute()
        +configure()
        +updateCapabilities()
    }
    
    class Execution {
        +UUID id
        +AIAgent agent
        +UUID taskId
        +ExecutionStatus status
        +DateTime startedAt
        +DateTime completedAt
        +ExecutionContext context
        +ExecutionResult result
        +start()
        +complete()
        +fail()
        +retry()
    }
    
    class ExecutionResult {
        +UUID id
        +ResultType type
        +Object data
        +List~Citation~ citations
        +Float confidence
        +String reasoning
        +validate()
        +generateReport()
    }
    
    class AgentCapability {
        +UUID id
        +String name
        +String description
        +CapabilityType type
        +List~String~ supportedOperations
        +Map~String,Object~ parameters
    }
    
    class ExecutionContext {
        +UUID id
        +Map~String,Object~ parameters
        +List~String~ requiredData
        +List~String~ outputFormat
        +SecurityContext security
        +User requestedBy
    }
    
    class Citation {
        +UUID id
        +String source
        +String title
        +String url
        +String excerpt
        +DateTime accessedAt
        +validate()
    }
    
    AIAgent "1" --> "*" Execution : "performs"
    Execution "1" --> "1" ExecutionResult : "produces"
    AIAgent "1" --> "*" AgentCapability : "has"
    Execution "1" --> "1" ExecutionContext : "uses"
    ExecutionResult "1" --> "*" Citation : "includes"
    
    class AgentType {
        <<enumeration>>
        STRATEGIC
        RESEARCH
        DEVELOPMENT
        QA
        SUPPORT
    }
    
    class ExecutionStatus {
        <<enumeration>>
        PENDING
        RUNNING
        COMPLETED
        FAILED
        CANCELLED
    }
```

### 5.2 AIエージェント専用ドメインサービス

```mermaid
classDiagram
    class AgentOrchestrationService {
        +selectOptimalAgent(Task task)
        +distributeWorkload(List~Task~ tasks)
        +coordinateAgents(List~AIAgent~ agents)
        +handleAgentConflicts(List~Execution~ executions)
    }
    
    class ExecutionMonitoringService {
        +monitorExecution(Execution execution)
        +detectAnomalies(Execution execution)
        +escalateToHuman(Execution execution)
        +generatePerformanceMetrics(AIAgent agent)
    }
    
    class KnowledgeIntegrationService {
        +searchKnowledgeBase(String query)
        +generateCitations(List~Source~ sources)
        +validateInformation(ExecutionResult result)
        +updateKnowledgeBase(ExecutionResult result)
    }
    
    AgentOrchestrationService ..> AIAgent
    ExecutionMonitoringService ..> Execution
    KnowledgeIntegrationService ..> ExecutionResult
```

---

## 🤝 6. Human-AI Collaboration Context

### 6.1 概念モデル

```mermaid
classDiagram
    class Workflow {
        +UUID id
        +String name
        +WorkflowType type
        +WorkflowStatus status
        +List~WorkflowStep~ steps
        +User initiator
        +DateTime startedAt
        +start()
        +pause()
        +resume()
        +complete()
    }
    
    class WorkflowStep {
        +UUID id
        +String name
        +StepType type
        +StepStatus status
        +User assignee
        +AIAgent agent
        +Duration timeout
        +Map~String,Object~ input
        +Map~String,Object~ output
        +execute()
        +approve()
        +reject()
    }
    
    class Approval {
        +UUID id
        +User approver
        +ApprovalStatus status
        +String comments
        +DateTime requestedAt
        +DateTime respondedAt
        +ApprovalLevel level
        +request()
        +approve()
        +reject()
        +delegate()
    }
    
    class Review {
        +UUID id
        +User reviewer
        +ReviewType type
        +ReviewStatus status
        +String feedback
        +List~ReviewComment~ comments
        +Rating rating
        +submit()
        +revise()
    }
    
    class CollaborationSession {
        +UUID id
        +List~User~ participants
        +AIAgent agent
        +SessionType type
        +SessionStatus status
        +DateTime startedAt
        +start()
        +invite()
        +end()
    }
    
    Workflow "1" --> "*" WorkflowStep : "contains"
    WorkflowStep "1" --> "*" Approval : "requires"
    WorkflowStep "1" --> "*" Review : "includes"
    Workflow "1" --> "*" CollaborationSession : "spawns"
    
    class WorkflowType {
        <<enumeration>>
        TASK_EXECUTION
        APPROVAL_PROCESS
        REVIEW_CYCLE
        AI_TRAINING
    }
    
    class StepType {
        <<enumeration>>
        HUMAN_ACTION
        AI_ACTION
        APPROVAL_GATE
        REVIEW_GATE
        DECISION_POINT
    }
```

---

## 📚 7. Knowledge Management Context

### 7.1 概念モデル

```mermaid
classDiagram
    class KnowledgeBase {
        +UUID id
        +String name
        +String description
        +KnowledgeType type
        +List~Document~ documents
        +VectorIndex index
        +search()
        +indexDocument()
        +updateIndex()
    }
    
    class Document {
        +UUID id
        +String title
        +String content
        +DocumentType type
        +String source
        +DateTime createdAt
        +DateTime updatedAt
        +User author
        +List~Tag~ tags
        +vectorize()
        +extractMetadata()
    }
    
    class VectorIndex {
        +UUID id
        +String indexName
        +Integer dimensions
        +String algorithm
        +Map~String,Object~ metadata
        +search()
        +insert()
        +update()
        +delete()
    }
    
    class SearchQuery {
        +UUID id
        +String query
        +QueryType type
        +Map~String,Object~ filters
        +Integer limit
        +Float threshold
        +execute()
        +refine()
    }
    
    class SearchResult {
        +UUID id
        +Document document
        +Float score
        +String excerpt
        +List~String~ highlights
        +rank()
    }
    
    class Citation {
        +UUID id
        +Document source
        +String excerpt
        +Integer startPosition
        +Integer endPosition
        +String context
        +validate()
        +format()
    }
    
    KnowledgeBase "1" --> "*" Document : "contains"
    KnowledgeBase "1" --> "1" VectorIndex : "uses"
    SearchQuery "1" --> "*" SearchResult : "produces"
    SearchResult "1" --> "1" Document : "references"
    Document "1" --> "*" Citation : "cited by"
    
    class KnowledgeType {
        <<enumeration>>
        TECHNICAL
        BUSINESS
        PROCESS
        REGULATORY
    }
    
    class DocumentType {
        <<enumeration>>
        SPECIFICATION
        MANUAL
        REPORT
        CODE
        EMAIL
    }
```

---

## 🔍 8. Audit & Compliance Context

### 8.1 概念モデル

```mermaid
classDiagram
    class AuditLog {
        +UUID id
        +String eventType
        +User actor
        +String resource
        +String action
        +Map~String,Object~ oldValues
        +Map~String,Object~ newValues
        +DateTime timestamp
        +String correlationId
        +String sessionId
        +record()
        +verify()
    }
    
    class Event {
        +UUID id
        +EventType type
        +EventSource source
        +String eventData
        +DateTime timestamp
        +String aggregateId
        +Integer version
        +publish()
        +replay()
    }
    
    class Trace {
        +UUID id
        +String traceId
        +String spanId
        +String parentSpanId
        +String operation
        +DateTime startTime
        +DateTime endTime
        +Map~String,Object~ tags
        +start()
        +finish()
    }
    
    class ComplianceRule {
        +UUID id
        +String name
        +String description
        +RuleType type
        +String condition
        +String action
        +Boolean active
        +evaluate()
        +enforce()
    }
    
    class AuditReport {
        +UUID id
        +String title
        +ReportType type
        +DateTime periodStart
        +DateTime periodEnd
        +List~AuditFinding~ findings
        +User generatedBy
        +generate()
        +export()
    }
    
    AuditLog "1" --> "*" Event : "tracks"
    Event "1" --> "*" Trace : "contains"
    ComplianceRule "1" --> "*" AuditLog : "validates"
    AuditReport "1" --> "*" AuditLog : "aggregates"
    
    class EventType {
        <<enumeration>>
        USER_ACTION
        AI_EXECUTION
        SYSTEM_EVENT
        SECURITY_EVENT
    }
    
    class EventSource {
        <<enumeration>>
        UI
        API
        AI_AGENT
        EXTERNAL_SYSTEM
    }
```

---

## 🔗 9. External Integration Context

### 9.1 概念モデル

```mermaid
classDiagram
    class Integration {
        +UUID id
        +String name
        +IntegrationType type
        +String endpoint
        +Map~String,String~ headers
        +AuthenticationConfig auth
        +Boolean active
        +connect()
        +disconnect()
        +test()
    }
    
    class RedmineIntegration {
        +String apiKey
        +String projectId
        +syncProjects()
        +syncTasks()
        +createTicket()
        +updateTicket()
    }
    
    class DatabricksIntegration {
        +String token
        +String workspace
        +String clusterId
        +executeJob()
        +queryData()
        +uploadDataset()
    }
    
    class VSCodeIntegration {
        +String extensionId
        +String version
        +Map~String,Object~ settings
        +installExtension()
        +updateSettings()
        +sendNotification()
    }
    
    class SyncStatus {
        +UUID id
        +Integration integration
        +SyncType type
        +SyncState state
        +DateTime lastSync
        +String errorMessage
        +sync()
        +retry()
    }
    
    Integration <|-- RedmineIntegration
    Integration <|-- DatabricksIntegration
    Integration <|-- VSCodeIntegration
    Integration "1" --> "*" SyncStatus : "monitors"
    
    class IntegrationType {
        <<enumeration>>
        REDMINE
        DATABRICKS
        VSCODE
        EXTERNAL_API
    }
    
    class SyncType {
        <<enumeration>>
        FULL_SYNC
        INCREMENTAL_SYNC
        REAL_TIME_SYNC
    }
```

---

## 📊 10. 集約とリポジトリパターン

### 10.1 主要集約

```mermaid
graph TD
    A[Project Aggregate] --> B[Project Root]
    A --> C[Task Entities]
    A --> D[Milestone Entities]
    
    E[User Aggregate] --> F[User Root]
    E --> G[Role Entities]
    E --> H[Permission Entities]
```

```mermaid
graph TD
    I[Execution Aggregate] --> J[Execution Root]
    I --> K[AI Agent Entity]
    I --> L[Result Entity]
    
    M[Workflow Aggregate] --> N[Workflow Root]
    M --> O[Step Entities]
    M --> P[Approval Entities]
```

| 集約          | 集約ルート | 境界内エンティティ                 | 不変条件                                                                            |
| ------------- | ---------- | ---------------------------------- | ----------------------------------------------------------------------------------- |
| **Project**   | Project    | Task, Milestone, WBS               | • タスクは1つのプロジェクトに属する<br>• マイルストーンは依存タスク完了後に達成可能 |
| **User**      | User       | UserRole, Permission               | • ユーザーは有効なロールのみ保持<br>• 権限は有効期限内のみ有効                      |
| **Execution** | Execution  | AIAgent, ExecutionResult, Citation | • 実行は1つのエージェントが担当<br>• 結果は実行完了後のみ生成                       |
| **Workflow**  | Workflow   | WorkflowStep, Approval, Review     | • ステップは順序に従って実行<br>• 承認は必要レベルを満たす必要                      |

### 10.2 リポジトリインターフェース

```mermaid
classDiagram
    class ProjectRepository {
        <<interface>>
        +findById(UUID id) Project
        +findByOwner(User owner) List~Project~
        +save(Project project) void
        +delete(UUID id) void
    }
    
    class TaskRepository {
        <<interface>>
        +findById(UUID id) Task
        +findByAssignee(User assignee) List~Task~
        +findByStatus(TaskStatus status) List~Task~
        +save(Task task) void
    }
```

```mermaid
classDiagram
    class ExecutionRepository {
        <<interface>>
        +findById(UUID id) Execution
        +findByAgent(AIAgent agent) List~Execution~
        +findByStatus(ExecutionStatus status) List~Execution~
        +save(Execution execution) void
    }
    
    class AuditLogRepository {
        <<interface>>
        +findByDateRange(DateTime start, DateTime end) List~AuditLog~
        +findByActor(User actor) List~AuditLog~
        +save(AuditLog log) void
    }
```

---

## 🏗️ 11. ドメインサービス

### 11.1 横断的ドメインサービス

```mermaid
classDiagram
    class HumanAICollaborationService {
        +orchestrateWorkflow(Workflow workflow)
        +escalateToHuman(Execution execution)
        +facilitateReview(Review review)
        +optimizeCollaboration(Project project)
    }
    
    class ApprovalPolicyService {
        +determineApprovalLevel(Task task)
        +validateApprover(User approver, ApprovalLevel level)
        +enforceApprovalPolicy(Approval approval)
    }
```

```mermaid
classDiagram
    class AuditingService {
        +recordAction(User actor, String action, Object resource)
        +generateAuditTrail(UUID entityId)
        +checkCompliance(ComplianceRule rule)
        +reportViolation(AuditLog log)
    }
    
    class AICapabilityService {
        +assessTaskComplexity(Task task)
        +matchAgentToTask(Task task)
        +evaluateAgentPerformance(AIAgent agent)
        +recommendCapabilityUpgrade(AIAgent agent)
    }
```

### 11.2 ドメインイベント

```mermaid
classDiagram
    class DomainEvent {
        <<abstract>>
        +UUID eventId
        +DateTime occurredAt
        +String aggregateId
        +Integer version
    }
    
    class TaskAssignedEvent {
        +UUID taskId
        +User assignee
        +User assignedBy
    }
    
    class ExecutionCompletedEvent {
        +UUID executionId
        +ExecutionResult result
        +Duration duration
    }
    
    class ApprovalRequestedEvent {
        +UUID approvalId
        +User approver
        +ApprovalLevel level
    }
    
    class KnowledgeUpdatedEvent {
        +UUID documentId
        +String changeType
        +User updatedBy
    }
    
    DomainEvent <|-- TaskAssignedEvent
    DomainEvent <|-- ExecutionCompletedEvent
    DomainEvent <|-- ApprovalRequestedEvent
    DomainEvent <|-- KnowledgeUpdatedEvent
```

---

## 📚 12. 用語集

| 用語                         | 定義                                                       | 出典                   |
| ---------------------------- | ---------------------------------------------------------- | ---------------------- |
| **AIエージェント**           | 特定の業務領域で自律的にタスクを実行するAIシステム         | 企画書§2, 要件定義書§4 |
| **HITL (Human-in-the-Loop)** | 重要な判断において人間の承認を必須とする仕組み             | 要件定義書§6           |
| **人機協調**                 | 人間とAIが役割分担しながら協力して業務を遂行すること       | 企画書§1               |
| **統合基盤**                 | Redmine、Databricks、VS Codeを連携させる統合システム       | 企画書§2               |
| **ワークフロー**             | 業務プロセスを定義し、人間とAIの協調を制御する仕組み       | 要件定義書§5           |
| **実行コンテキスト**         | AIエージェントがタスクを実行する際の環境情報や制約         | 設計独自定義           |
| **引用（Citation）**         | AIが生成した結果の根拠となる情報源への参照                 | 要件定義書FR-010       |
| **監査ログ**                 | システム内の全ての操作を記録し、後から検証可能にしたデータ | 要件定義書FR-008       |
| **承認レベル**               | 操作の重要度に応じて設定される承認権限のレベル             | 設計独自定義           |
| **集約**                     | 整合性境界を持つエンティティの集まり                       | DDD設計原則            |

---

## 📋 13. 設計制約と決定

### 13.1 アーキテクチャ制約

| 制約項目             | 制約内容                            | 影響                 | 対応策                               |
| -------------------- | ----------------------------------- | -------------------- | ------------------------------------ |
| **外部システム依存** | Redmine/Databricks/VS CodeのAPI制限 | 機能実装の制約       | Adapter パターンで抽象化             |
| **認証基盤**         | 既存SSO基盤との統合必須             | 認証設計の制約       | 標準プロトコル（OIDC）採用           |
| **データ整合性**     | 複数システム間のデータ同期          | 整合性保証の複雑性   | Eventually Consistent + Saga Pattern |
| **AI実行時間**       | AIモデルの応答時間制限              | ユーザー体験への影響 | 非同期処理 + プログレス表示          |

### 13.2 ドメイン設計決定

| 決定事項                   | 理由                         | 代替案           | トレードオフ               |
| -------------------------- | ---------------------------- | ---------------- | -------------------------- |
| **マイクロサービス境界**   | 技術境界とドメイン境界の整合 | モノリシック設計 | 複雑性 vs 拡張性           |
| **イベントソーシング採用** | 完全な監査証跡確保           | CRUD + 監査ログ  | ストレージコスト vs 透明性 |
| **強い型付け**             | コンパイル時エラー検出       | 動的型付け       | 開発速度 vs 品質           |
| **集約サイズ制限**         | 性能とトランザクション境界   | 大きな集約       | 性能 vs 整合性             |

---

## 📚 関連文書

### 📖 上位文書
- [企画書](../../010000_企画/011000_企画書.md)
- [要件定義書](../../020000_要件定義/021000_要件定義書.md)
- [設計方針](../031000_設計方針/031010_設計方針.md)

### 📋 関連設計文書
- [全体構成](../033000_アーキテクチャ/033010_全体構成.md)
- [ユースケース設計](034020_ユースケース設計.md)
- [データ設計](../035000_データ設計/035010_ER図.mmd)
- [API設計](../036000_API設計/036010_API一覧.md)

---

## 📅 更新履歴

| 日時       | 担当               | 変更概要                                   |
| ---------- | ------------------ | ------------------------------------------ |
| 2025-09-07 | システム開発チーム | 初版作成、人機協調基盤のドメインモデル設計 |

